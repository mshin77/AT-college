
---
title: ''
format:
  html:
    code-fold: false
    code-tools: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
```

[This website](https://at-college.netlify.app) contains `R codes` used for the analyses in the manuscript titled `"Effects of interactive and hands-on learning experience of assistive technology on college students' perspectives and knowledge: A quasi-experimental study."` The scripts were also posted through an online data repository at [https://osf.io](https://osf.io/cgmdj/?view_only=c98ebb08447c4ca0b5e1a28f1b0269f2).

::: panel-tabset

## Load Models  

```{r}
#| code-fold: true
suppressPackageStartupMessages({
  library(gtsummary)
  library(flextable)
  library(purrr)
  library(ggeffects)
  library(ggplot2)
  library(dplyr)
  library(ordinal)
  library(texreg)
  library(MASS)
  library(nlme)
})

load("data/AT-college.RData")
```

#### Demographic Profiles of Participants

```{r, eval = FALSE}
df$group <- as.factor(df$group)

demo_tbl <- df %>%
  mutate(group = case_when(
    group == "1" ~ "Treatment",
    group == "0" ~ "Control"
  )) %>%
  filter(time == "0") %>%
  dplyr::select(group, gender, year, college, myself, family, classmates) %>%
  tbl_summary(by = group,
              percent = "column") 

demo_tbl_ft <- as_flex_table(demo_tbl)
```


```{r, echo = FALSE}
demo_tbl_ft 
```

## Perceived Perspectives

#### Main Effects (PP)

**PP1** 

```{r, eval = FALSE}
df$PP1 <- as.factor(df$PP1)

main.PP1 <- clmm(PP1 ~ group + time + group:time +
                    (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(main.PP1)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

**PP2**

```{r, eval = FALSE}
df$PP2 <- as.factor(df$PP2)

main.PP2 <- clmm(PP2 ~ group + time + group:time +
                    (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(main.PP2)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:3, 1] <- cf[1:3, 1]*-1
cf[1:3, 3] <- cf[1:3, 3]*-1
rownames(cf)[1:3] <- c("rating > 4", "rating > 3", "rating > 2")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

**PP3**

```{r, eval = FALSE}
df$PP3 <- as.factor(df$PP3)

main.PP3 <- clmm(PP3 ~ group + time + group:time +
                    (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(main.PP3)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

**PP4**

```{r, eval = FALSE}
df$PP4 <- as.factor(df$PP4)

main.PP4 <- clmm(PP4 ~ group + time + group:time +
                    (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(main.PP4)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

**PP5**

```{r, eval = FALSE}
df$PP5 <- as.factor(df$PP5)

main.PP5 <- clmm(PP5 ~ group + time + group:time +
                    (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(main.PP5)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

**PP6**

```{r, eval = FALSE}
df$PP6 <- as.factor(df$PP6)

main.PP6 <- clmm(PP6 ~ group + time + group:time +
                    (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(main.PP6)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

**PP7**

```{r, eval = FALSE}
df$PP7 <- as.factor(df$PP7)

main.PP7 <- clmm(PP7 ~ group + time + group:time +
                    (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(main.PP7)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

**PP8**

```{r, eval = FALSE}
df$PP8 <- as.factor(df$PP8)

main.PP8 <- clmm(PP8 ~ group + time + group:time +
                    (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(main.PP8)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

```{r, echo = FALSE}
screenreg(list(main.PP1, main.PP2, main.PP3, main.PP4, main.PP5, main.PP6, main.PP7, main.PP8), 
          custom.model.names = c("PP 1", "PP 2", "PP 3", "PP 4", "PP 5", "PP 6", "PP 7", "PP 8"))
```

#### Moderation Effects (PP)

**PP1** 

```{r, eval = FALSE}
df$PP1 <- as.factor(df$PP1)

model.PP1 <- clmm(PP1 ~ family + classmates + 
                group + family:group + classmates:group +
                time +  family:time + classmates:time +
                group:time + family:group:time + classmates:group:time + 
                    (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(model.PP1)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

**PP2**

```{r, eval = FALSE}
df$PP2 <- as.factor(df$PP2)

model.PP2 <- clmm(PP2 ~ family + classmates + 
                group + family:group + classmates:group +
                time + family:time + classmates:time +
                group:time + family:group:time + classmates:group:time + 
                    (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(model.PP2)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:3, 1] <- cf[1:3, 1]*-1
cf[1:3, 3] <- cf[1:3, 3]*-1
rownames(cf)[1:3] <- c("rating > 4", "rating > 3", "rating > 2")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

**PP3**

```{r, eval = FALSE}
df$PP3 <- as.factor(df$PP3)

model.PP3 <- clmm(PP3 ~ myself + family + classmates + 
                group + myself:group + family:group + classmates:group +
                time + myself:time + family:time + classmates:time +
                group:time + myself:group:time + family:group:time + classmates:group:time + 
                    (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(model.PP3)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```
```{r}
summary(main.PP7)
```


**PP4**

```{r, eval = FALSE}
df$PP4 <- as.factor(df$PP4)

model.PP4 <- clmm(PP4 ~ myself + family + classmates + 
                group + myself:group + family:group + classmates:group +
                time + myself:time + family:time + classmates:time +
                group:time + myself:group:time + family:group:time + classmates:group:time + 
                    (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(model.PP4)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

**PP5**

```{r, eval = FALSE}
df$PP5 <- as.factor(df$PP5)

model.PP5 <- clmm(PP5 ~ myself + family + classmates + 
                group + myself:group + family:group + classmates:group +
                time + myself:time + family:time + classmates:time +
                group:time + myself:group:time + family:group:time + classmates:group:time + 
                    (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(model.PP5)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

**PP6**

```{r, eval = FALSE}
df$PP6 <- as.factor(df$PP6)

model.PP6 <- clmm(PP6 ~ myself + family + classmates + 
                group + myself:group + family:group + classmates:group +
                time + myself:time + family:time + classmates:time +
                group:time + myself:group:time + family:group:time + classmates:group:time + 
                    (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(model.PP6)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

**PP7**

```{r, eval = FALSE}
df$PP7 <- as.factor(df$PP7)

model.PP7 <- clmm(PP7 ~ myself + family + classmates + 
                group + myself:group + family:group + classmates:group +
                time + myself:time + family:time + classmates:time +
                group:time + myself:group:time + family:group:time + classmates:group:time + 
                    (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(model.PP7)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

**PP8**

```{r, eval = FALSE}
df$PP8 <- as.factor(df$PP8)

model.PP8 <- clmm(PP8 ~ myself + family + classmates + 
                group + myself:group + family:group + classmates:group +
                time + myself:time + family:time + classmates:time +
                group:time + myself:group:time + family:group:time + classmates:group:time + 
                    (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(model.PP8)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```


```{r, echo = FALSE}
screenreg(list(model.PP1, model.PP2, model.PP3, model.PP4, model.PP5, model.PP6, model.PP7, model.PP8), 
          custom.model.names = c("PP 1", "PP 2", "PP 3", "PP 4", "PP 5", "PP 6", "PP 7", "PP 8"))
```

## Perceived Knowledge 

#### Main Effects (PK)

**PK1**

```{r, eval = FALSE}
df$PK1 <- as.factor(df$PK1)

main.PK1 <- clmm(PK1 ~ group + time + group:time +
                    (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(main.PK1)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

**PK2**

```{r, eval = FALSE}
df$PK2 <- as.factor(df$PK2)

main.PK2 <- clmm(PK2 ~ group + time + group:time +
                    (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(main.PK2 )
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

**PK3**

```{r, eval = FALSE}
df$PK3 <- as.factor(df$PK3)

main.PK3 <- clmm(PK3 ~ group + time + group:time +
                    (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(main.PK3 )
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

**PK4**

```{r, eval = FALSE}
df$PK4 <- as.factor(df$PK4)

main.PK4 <- clmm(PK4 ~ group + time + group:time +
                    (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(main.PK4 )
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

**PK5**

```{r, eval = FALSE}
df$PK5 <- as.factor(df$PK5)

main.PK5 <- clmm(PK5 ~ group + time + group:time +
                    (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(main.PK5)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

**PK6**

```{r, eval = FALSE}
df$PK6 <- as.factor(df$PK6)

main.PK6 <- clmm(PK6 ~ group + time + group:time +
                    (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(main.PK6)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

**PK7**

```{r, eval = FALSE}
df$PK7 <- as.factor(df$PK7)

main.PK7 <- clmm(PK7 ~ group + time + group:time +
                    (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(main.PK7)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

```{r, echo = FALSE}
screenreg(list(main.PK1, main.PK2, main.PK3, main.PK4, main.PK5, main.PK6, main.PK7), 
          custom.model.names = c("PK 1", "PK 2", "PK 3", "PK 4", "PK 5", "PK 6", "PK 7"))
```

#### Moderation Effects (PK)

**PK1**

```{r, eval = FALSE}
model.PK1 <- clmm(PK1 ~ myself + family + classmates + 
                group + myself:group + family:group + classmates:group +
                time + myself:time + family:time + classmates:time +
                group:time + myself:group:time + family:group:time + classmates:group:time + 
                (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(model.PK1)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

**PK2**

```{r, eval = FALSE}
model.PK2 <- clmm(PK2 ~ myself + family + classmates + 
                group + myself:group + family:group + classmates:group +
                time + myself:time + family:time + classmates:time +
                group:time + myself:group:time + family:group:time + classmates:group:time + 
                (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(model.PK2)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

**PK3**

```{r, eval = FALSE}
model.PK3 <- clmm(PK3 ~ myself + family + classmates + 
                group + myself:group + family:group + classmates:group +
                time + myself:time + family:time + classmates:time +
                group:time + myself:group:time + family:group:time + classmates:group:time + 
                (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(model.PK3)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

**PK4**

```{r, eval = FALSE}
model.PK4 <- clmm(PK4 ~ myself + family + classmates + 
                group + myself:group + family:group + classmates:group +
                time + myself:time + family:time + classmates:time +
                group:time + myself:group:time + family:group:time + classmates:group:time + 
                (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(model.PK4)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

**PK5**

```{r, eval = FALSE}
model.PK5 <- clmm(PK5 ~ myself + family + classmates + 
                group + myself:group + family:group + classmates:group +
                time + myself:time + family:time + classmates:time +
                group:time + myself:group:time + family:group:time + classmates:group:time + 
                (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(model.PK5)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

**PK6**

```{r, eval = FALSE}
model.PK6 <- clmm(PK6 ~ myself + family + classmates + 
                group + myself:group + family:group + classmates:group +
                time + myself:time + family:time + classmates:time +
                group:time + myself:group:time + family:group:time + classmates:group:time + 
                (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(model.PK6)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

**PK7**

```{r, eval = FALSE}
model.PK7 <- clmm(PK7 ~ myself + family + classmates + 
                group + myself:group + family:group + classmates:group +
                time + myself:time + family:time + classmates:time +
                group:time + myself:group:time + family:group:time + classmates:group:time + 
                (1 | student), data = df, Hess=TRUE, nAGQ=7)
```


```{r, echo = FALSE}
sum <- summary(model.PK7)
cf <- sum$coefficients %>% as.data.frame() 

cf[1:4, 1] <- cf[1:4, 1]*-1
cf[1:4, 3] <- cf[1:4, 3]*-1
rownames(cf)[1:4] <- c("rating > 4", "rating > 3", "rating > 2", "rating > 1")
cf %>% mutate(odd_ratio = exp(Estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```


```{r, echo = FALSE}
screenreg(list(model.PK1, model.PK2, model.PK3, model.PK4, model.PK5, model.PK6, model.PK7), 
          custom.model.names = c("PK 1", "PK 2", "PK 3", "PK 4", "PK 5", "PK 6", "PK 7"))
```


## Demonstrated Knowledge 

#### Main Effects (DK)

```{r, eval = FALSE}
main.DK <- glmmPQL(DK ~ group + time + group:time,
                random = ~ 1 | student, data = df, family=poisson)
```

```{r, echo = FALSE}
fixed <- intervals(main.DK,which="fixed")

df <- data.frame(col = rep(NA, 4))
df <- df[,-1, drop = FALSE]
df$variable <- rownames(fixed$fixed)
df$estimate <- fixed$fixed[, "est."]
df$lower <- fixed$fixed[, "lower"]
df$upper <- fixed$fixed[, "upper"]

df %>% mutate(incidence_rate_ratio = exp(estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

```{r, echo = FALSE}
VarCorr(main.DK)
```

#### Moderation Effects (DK)

```{r, eval = FALSE}
model.DK <- glmmPQL(DK ~ myself + family + classmates + 
                    group + myself:group + family:group + classmates:group + 
                    time + myself:time + family:time + classmates:time + 
                    group:time + myself:group:time + family:group:time + classmates:group:time,
                random = ~ 1 | student, data = df, family=poisson)
```

```{r, echo = FALSE}
fixed <- intervals(model.DK,which="fixed")

df <- data.frame(col = rep(NA, 16))
df <- df[,-1, drop = FALSE]
df$variable <- rownames(fixed$fixed)
df$estimate <- fixed$fixed[, "est."]
df$lower <- fixed$fixed[, "lower"]
df$upper <- fixed$fixed[, "upper"]

df %>% mutate(incidence_rate_ratio = exp(estimate)) %>% 
  mutate_if(is.numeric, ~ round(., 3))
```

```{r, echo = FALSE}
VarCorr(model.DK)
```

```{r, echo = FALSE}
screenreg(list(main.DK, model.DK), 
          custom.model.names = c("DK Main Effects", "DK Moderation Effects"))
```

:::
